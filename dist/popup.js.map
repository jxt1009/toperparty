{"version":3,"file":"popup.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,oBAAoB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,UAAU,8CAA8C;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,6BAA6B;AACrC;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,oBAAoB;AACnD;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://toperparty/./chrome-extension/popup.js"],"sourcesContent":["// popup.js - Extension popup UI\r\n\r\nlet status = {\r\n  isConnected: false,\r\n  roomId: null,\r\n  userId: null,\r\n  hasLocalStream: false\r\n};\r\n\r\n// DOM elements\r\nconst statusEl = document.getElementById('status');\r\nconst statusText = document.getElementById('status-text');\r\nconst controlsSection = document.getElementById('controls-section');\r\nconst partyInfo = document.getElementById('party-info');\r\nconst videoSection = document.getElementById('video-section');\r\nconst startBtn = document.getElementById('start-btn');\r\nconst stopBtn = document.getElementById('stop-btn');\r\nconst roomInput = document.getElementById('room-input');\r\nconst roomDisplay = document.getElementById('room-display');\r\nconst userDisplay = document.getElementById('user-display');\r\nconst localVideo = document.getElementById('local-video');\r\nconst remoteVideo = document.getElementById('remote-video');\r\nconst copyRoomBtn = document.getElementById('copy-room-btn');\r\n\r\n// Initialize\r\nupdateStatus();\r\nsetupEventListeners();\r\nstartStatusPolling();\r\n\r\nfunction setupEventListeners() {\r\n  startBtn.addEventListener('click', startParty);\r\n  stopBtn.addEventListener('click', stopParty);\r\n  copyRoomBtn.addEventListener('click', copyRoomId);\r\n}\r\n\r\nfunction updateStatus() {\r\n  console.log('updateStatus called');\r\n  chrome.runtime.sendMessage({ type: 'GET_STATUS' }, (response) => {\r\n    console.log('GET_STATUS response:', response);\r\n    if (chrome.runtime.lastError) {\r\n      console.error('Failed to get status:', chrome.runtime.lastError);\r\n      return;\r\n    }\r\n    if (response) {\r\n      status = response;\r\n      console.log('Status updated:', status);\r\n      updateUI();\r\n    } else {\r\n      console.warn('No response from background script');\r\n    }\r\n  });\r\n}\r\n\r\nfunction updateUI() {\r\n  const { isConnected, roomId, userId, hasLocalStream } = status;\r\n\r\n  if (isConnected) {\r\n    statusEl.className = 'status connected';\r\n    statusText.textContent = 'ðŸŸ¢ Connected';\r\n    controlsSection.classList.remove('hidden');\r\n    startBtn.classList.add('hidden');\r\n    stopBtn.classList.remove('hidden');\r\n    partyInfo.classList.remove('hidden');\r\n    //videoSection.classList.remove('hidden');\r\n    roomDisplay.textContent = roomId;\r\n    userDisplay.textContent = userId;\r\n\r\n    // Display local video (will be set when stream is available)\r\n    // Note: Local stream is managed by the background script\r\n  } else {\r\n    statusEl.className = 'status disconnected';\r\n    statusText.textContent = 'ðŸ”´ Disconnected';\r\n    controlsSection.classList.remove('hidden');\r\n    startBtn.classList.remove('hidden');\r\n    stopBtn.classList.add('hidden');\r\n    partyInfo.classList.add('hidden');\r\n    videoSection.classList.add('hidden');\r\n    localVideo.srcObject = null;\r\n    remoteVideo.srcObject = null;\r\n  }\r\n}\r\n\r\nasync function startParty() {\r\n  const roomId = roomInput.value.trim() || undefined;\r\n\r\n  try {\r\n    startBtn.disabled = true;\r\n    statusText.textContent = 'â³ Connecting...';\r\n\r\n    chrome.runtime.sendMessage(\r\n      { type: 'START_PARTY', roomId },\r\n      (response) => {\r\n        if (response.success) {\r\n          console.log('Party started successfully');\r\n          setTimeout(updateStatus, 500);\r\n        } else {\r\n          alert('Error: ' + response.error);\r\n          statusText.textContent = 'ðŸ”´ Disconnected';\r\n          startBtn.disabled = false;\r\n        }\r\n      }\r\n    );\r\n  } catch (err) {\r\n    alert('Error starting party: ' + err.message);\r\n    startBtn.disabled = false;\r\n  }\r\n}\r\n\r\nfunction stopParty() {\r\n  chrome.runtime.sendMessage({ type: 'STOP_PARTY' }, () => {\r\n    roomInput.value = '';\r\n    updateStatus();\r\n  });\r\n}\r\n\r\nfunction copyRoomId() {\r\n  if (status.roomId) {\r\n    navigator.clipboard.writeText(status.roomId);\r\n    copyRoomBtn.textContent = 'âœ“';\r\n    setTimeout(() => {\r\n      copyRoomBtn.textContent = 'ðŸ“‹';\r\n    }, 2000);\r\n  }\r\n}\r\n\r\nfunction startStatusPolling() {\r\n  // Initial status check\r\n  updateStatus();\r\n  // Then poll every 2 seconds\r\n  setInterval(updateStatus, 2000);\r\n}\r\n\r\n// Listen for remote stream\r\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\r\n  if (request.type === 'REMOTE_STREAM_RECEIVED') {\r\n    console.log('Received remote stream');\r\n    remoteVideo.srcObject = request.stream;\r\n  }\r\n});\r\n"],"names":[],"ignoreList":[],"sourceRoot":""}